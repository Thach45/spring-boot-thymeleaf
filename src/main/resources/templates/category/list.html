<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <title>Category List</title>
</head>
<body>
    <div layout:fragment="content">
        <h2 class="mb-4">Category Management</h2>
        
        <!-- Search Box -->
        <div class="search-box">
            <form th:action="@{/categories}" method="get" class="row g-3">
                <div class="col-auto">
                    <input type="text" class="form-control" name="keyword" th:value="${keyword}"
                           placeholder="Search categories...">
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-primary">Search</button>
                    <a th:href="@{/categories}" class="btn btn-secondary">Clear</a>
                </div>
                <div class="col-auto ms-auto">
                    <a th:href="@{/categories/create}" class="btn btn-success">Add New Category</a>
                </div>
            </form>
        </div>

        <!-- Categories Table -->
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="category : ${categories}">
                        <td th:text="${category.id}"></td>
                        <td th:text="${category.name}"></td>
                        <td th:text="${category.description}"></td>
                        <td>
                            <a th:href="@{/categories/edit/{id}(id=${category.id})}"
                               class="btn btn-sm btn-primary">Edit</a>
                            <a th:href="@{/categories/delete/{id}(id=${category.id})}"
                               class="btn btn-sm btn-danger"
                               onclick="return confirm('Are you sure you want to delete this category?')">Delete</a>
                        </td>
                    </tr>
                    <tr th:if="${categories.empty}">
                        <td colspan="4" class="text-center">No categories found</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <nav th:if="${categories.totalPages > 1}">
            <ul class="pagination">
                <li class="page-item" th:classappend="${categories.first ? 'disabled' : ''}">
                    <a class="page-link" th:href="@{/categories(page=${categories.number - 1}, keyword=${keyword})}">&laquo;</a>
                </li>
                <li class="page-item" th:each="i : ${#numbers.sequence(0, categories.totalPages - 1)}"
                    th:classappend="${i == categories.number ? 'active' : ''}">
                    <a class="page-link" th:href="@{/categories(page=${i}, keyword=${keyword})}" th:text="${i + 1}"></a>
                </li>
                <li class="page-item" th:classappend="${categories.last ? 'disabled' : ''}">
                    <a class="page-link" th:href="@{/categories(page=${categories.number + 1}, keyword=${keyword})}">&raquo;</a>
                </li>
            </ul>
        </nav>
    </div>
</body>
</html>
